version: "3.7"
services:

## --------------------------- GOWA --------------------------- ##

  {{ service_name }}:
    image: aldinokemal2104/go-whatsapp-web-multidevice:latest ## Imagem oficial GOWA
    container_name: {{ service_name }}
    restart: always
    
    networks:
      - {{ network_name }} ## Nome da rede interna
    
    # Sem exposi√ß√£o direta de porta - acesso apenas via Traefik/HTTPS
    
    environment:
      ## üîß Configura√ß√µes B√°sicas
      - APP_PORT=3000
      - APP_DEBUG=false
      - APP_OS=Chrome
      
      ## üîê Autentica√ß√£o B√°sica Obrigat√≥ria
      - APP_BASIC_AUTH={{ basic_auth }}
      
      ## üìÇ Caminho Base (comentado para configura√ß√£o inicial)
      # - APP_BASE_PATH={{ base_path }}
      
      ## üíæ Banco de Dados (comentado para configura√ß√£o inicial)
      # - DB_URI={{ database_uri }}
      
      ## ü§ñ Auto Reply (comentado para configura√ß√£o inicial)
      # - WHATSAPP_AUTO_REPLY={{ auto_reply_message }}
      # - WHATSAPP_AUTO_MARK_READ={{ auto_mark_read }}
      
      ## üîó Webhook (comentado para configura√ß√£o inicial)
      # - WHATSAPP_WEBHOOK={{ webhook_url }}
      # - WHATSAPP_WEBHOOK_SECRET={{ webhook_secret }}
      
      ## ‚úÖ Valida√ß√µes (comentado para configura√ß√£o inicial)
      # - WHATSAPP_ACCOUNT_VALIDATION={{ account_validation }}
      # - WHATSAPP_CHAT_STORAGE={{ chat_storage }}
    
    volumes:
      - {{ service_name }}_data:/app/storages ## Volume para armazenamento persistente
    
    command: ["rest"] ## Modo REST API
    
    labels:
      ## üåê Traefik - Proxy Reverso
      - "traefik.enable=true"
      - "traefik.docker.network={{ network_name }}"
      
      ## üìç Roteamento HTTP
      - "traefik.http.routers.{{ service_name }}.rule=Host(`{{ domain }}`)"
      - "traefik.http.routers.{{ service_name }}.entrypoints=websecure"
      - "traefik.http.routers.{{ service_name }}.tls.certresolver=letsencryptresolver"
      
      ## üéØ Servi√ßo
      - "traefik.http.services.{{ service_name }}.loadbalancer.server.port=3000"

## --------------------------- VOLUMES --------------------------- ##
volumes:
  {{ service_name }}_data:

## --------------------------- REDE --------------------------- ##
networks:
  {{ network_name }}:
    external: true
